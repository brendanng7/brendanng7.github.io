const Instagram_html = '<div class="instagram m-3"><a href="https://www.instagram.com/brendan.ng_/" target="_blank"><svg class="socials"xmlns="http://www.w3.org/2000/svg"fill="currentColor"viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" /></svg></a></div>';
const Linkedin_html = '<div class="linkedin m-3"><a href="https://www.linkedin.com/in/brendan-ng-169b0b276/" target="_blank"><svg xmlns="http://www.w3.org/2000/svg"class="socials"fill="currentColor"viewBox="0 0 24 24"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z" /></svg></a></div>';
const Telegram_html = '<div class="telegram m-3"><a href="https://t.me/Brendanng7" target="_blank"><svg class="socials"fill="currentColor"viewbox="0 0 24 24"version="1.1"xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"xml:space="preserve"xmlns:serif="http://www.serif.com/"style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;"><path id="telegram-1"d="M18.384,22.779c0.322,0.228 0.737,0.285 1.107,0.145c0.37,-0.141 0.642,-0.457 0.724,-0.84c0.869,-4.084 2.977,-14.421 3.768,-18.136c0.06,-0.28 -0.04,-0.571 -0.26,-0.758c-0.22,-0.187 -0.525,-0.241 -0.797,-0.14c-4.193,1.552 -17.106,6.397 -22.384,8.35c-0.335,0.124 -0.553,0.446 -0.542,0.799c0.012,0.354 0.25,0.661 0.593,0.764c2.367,0.708 5.474,1.693 5.474,1.693c0,0 1.452,4.385 2.209,6.615c0.095,0.28 0.314,0.5 0.603,0.576c0.288,0.075 0.596,-0.004 0.811,-0.207c1.216,-1.148 3.096,-2.923 3.096,-2.923c0,0 3.572,2.619 5.598,4.062Zm-11.01,-8.677l1.679,5.538l0.373,-3.507c0,0 6.487,-5.851 10.185,-9.186c0.108,-0.098 0.123,-0.262 0.033,-0.377c-0.089,-0.115 -0.253,-0.142 -0.376,-0.064c-4.286,2.737 -11.894,7.596 -11.894,7.596Z" /></svg></a></div>';
const Github_html = '<div class="github m-3"><a href="https://github.com/brendanng7" target="_blank"><svg class="socials" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" /></svg></a></div>'


const python_html = '<div class="group flex relative"><svg viewBox="0 0 128 128" style="height: 3rem;"><linearGradient id="python-original-a" gradientUnits="userSpaceOnUse" x1="70.252" y1="1237.476" x2="170.659" y2="1151.089" gradientTransform="matrix(.563 0 0 -.568 -29.215 707.817)"><stop offset="0" stop-color="#5A9FD4"></stop><stop offset="1" stop-color="#306998"></stop></linearGradient><linearGradient id="python-original-b" gradientUnits="userSpaceOnUse" x1="209.474" y1="1098.811" x2="173.62" y2="1149.537" gradientTransform="matrix(.563 0 0 -.568 -29.215 707.817)"><stop offset="0" stop-color="#FFD43B"></stop><stop offset="1" stop-color="#FFE873"></stop></linearGradient><path fill="url(#python-original-a)" d="M63.391 1.988c-4.222.02-8.252.379-11.8 1.007-10.45 1.846-12.346 5.71-12.346 12.837v9.411h24.693v3.137H29.977c-7.176 0-13.46 4.313-15.426 12.521-2.268 9.405-2.368 15.275 0 25.096 1.755 7.311 5.947 12.519 13.124 12.519h8.491V67.234c0-8.151 7.051-15.34 15.426-15.34h24.665c6.866 0 12.346-5.654 12.346-12.548V15.833c0-6.693-5.646-11.72-12.346-12.837-4.244-.706-8.645-1.027-12.866-1.008zM50.037 9.557c2.55 0 4.634 2.117 4.634 4.721 0 2.593-2.083 4.69-4.634 4.69-2.56 0-4.633-2.097-4.633-4.69-.001-2.604 2.073-4.721 4.633-4.721z" transform="translate(0 10.26)"></path><path fill="url(#python-original-b)" d="M91.682 28.38v10.966c0 8.5-7.208 15.655-15.426 15.655H51.591c-6.756 0-12.346 5.783-12.346 12.549v23.515c0 6.691 5.818 10.628 12.346 12.547 7.816 2.297 15.312 2.713 24.665 0 6.216-1.801 12.346-5.423 12.346-12.547v-9.412H63.938v-3.138h37.012c7.176 0 9.852-5.005 12.348-12.519 2.578-7.735 2.467-15.174 0-25.096-1.774-7.145-5.161-12.521-12.348-12.521h-9.268zM77.809 87.927c2.561 0 4.634 2.097 4.634 4.692 0 2.602-2.074 4.719-4.634 4.719-2.55 0-4.633-2.117-4.633-4.719 0-2.595 2.083-4.692 4.633-4.692z" transform="translate(0 10.26)"></path><radialGradient id="python-original-c" cx="1825.678" cy="444.45" r="26.743" gradientTransform="matrix(0 -.24 -1.055 0 532.979 557.576)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#B8B8B8" stop-opacity=".498"></stop><stop offset="1" stop-color="#7F7F7F" stop-opacity="0"></stop></radialGradient><path opacity=".444" fill="url(#python-original-c)" d="M97.309 119.597c0 3.543-14.816 6.416-33.091 6.416-18.276 0-33.092-2.873-33.092-6.416 0-3.544 14.815-6.417 33.092-6.417 18.275 0 33.091 2.872 33.091 6.417z"></path></svg><span class="tooltip">Python</span></div>';
const css_html = '<div class="group flex relative"><svg viewBox="0 0 128 128" style="height: 3rem;"><path fill="#1572B6" d="M18.814 114.123L8.76 1.352h110.48l-10.064 112.754-45.243 12.543-45.119-12.526z"></path><path fill="#33A9DC" d="M64.001 117.062l36.559-10.136 8.601-96.354h-45.16v106.49z"></path><path fill="#fff" d="M64.001 51.429h18.302l1.264-14.163H64.001V23.435h34.682l-.332 3.711-3.4 38.114h-30.95V51.429z"></path><path fill="#EBEBEB" d="M64.083 87.349l-.061.018-15.403-4.159-.985-11.031H33.752l1.937 21.717 28.331 7.863.063-.018v-14.39z"></path><path fill="#fff" d="M81.127 64.675l-1.666 18.522-15.426 4.164v14.39l28.354-7.858.208-2.337 2.406-26.881H81.127z"></path><path fill="#EBEBEB" d="M64.048 23.435v13.831H30.64l-.277-3.108-.63-7.012-.331-3.711h34.646zm-.047 27.996v13.831H48.792l-.277-3.108-.631-7.012-.33-3.711h16.447z"></path></svg><span class="tooltip">CSS3</span></div>';
const html_html = '<div class="group flex relative"><svg viewBox="0 0 128 128" style="height: 3rem;"><path fill="#E44D26" d="M19.037 113.876L9.032 1.661h109.936l-10.016 112.198-45.019 12.48z"></path><path fill="#F16529" d="M64 116.8l36.378-10.086 8.559-95.878H64z"></path><path fill="#EBEBEB" d="M64 52.455H45.788L44.53 38.361H64V24.599H29.489l.33 3.692 3.382 37.927H64zm0 35.743l-.061.017-15.327-4.14-.979-10.975H33.816l1.928 21.609 28.193 7.826.063-.017z"></path><path fill="#fff" d="M63.952 52.455v13.763h16.947l-1.597 17.849-15.35 4.143v14.319l28.215-7.82.207-2.325 3.234-36.233.335-3.696h-3.708zm0-27.856v13.762h33.244l.276-3.092.628-6.978.329-3.692z"></path></svg><span class="tooltip">HTML5</span></div>';
const javascript_html = '<div class="group flex relative"><svg viewBox="0 0 128 128" style="height: 3rem;"><path fill="#F0DB4F" d="M1.408 1.408h125.184v125.185H1.408z"></path><path fill="#323330" d="M116.347 96.736c-.917-5.711-4.641-10.508-15.672-14.981-3.832-1.761-8.104-3.022-9.377-5.926-.452-1.69-.512-2.642-.226-3.665.821-3.32 4.784-4.355 7.925-3.403 2.023.678 3.938 2.237 5.093 4.724 5.402-3.498 5.391-3.475 9.163-5.879-1.381-2.141-2.118-3.129-3.022-4.045-3.249-3.629-7.676-5.498-14.756-5.355l-3.688.477c-3.534.893-6.902 2.748-8.877 5.235-5.926 6.724-4.236 18.492 2.975 23.335 7.104 5.332 17.54 6.545 18.873 11.531 1.297 6.104-4.486 8.08-10.234 7.378-4.236-.881-6.592-3.034-9.139-6.949-4.688 2.713-4.688 2.713-9.508 5.485 1.143 2.499 2.344 3.63 4.26 5.795 9.068 9.198 31.76 8.746 35.83-5.176.165-.478 1.261-3.666.38-8.581zM69.462 58.943H57.753l-.048 30.272c0 6.438.333 12.34-.714 14.149-1.713 3.558-6.152 3.117-8.175 2.427-2.059-1.012-3.106-2.451-4.319-4.485-.333-.584-.583-1.036-.667-1.071l-9.52 5.83c1.583 3.249 3.915 6.069 6.902 7.901 4.462 2.678 10.459 3.499 16.731 2.059 4.082-1.189 7.604-3.652 9.448-7.401 2.666-4.915 2.094-10.864 2.07-17.444.06-10.735.001-21.468.001-32.237z"></path></svg><span class="tooltip">Javascript</span></div>';

const tailwindcss_html = '<div class="group flex relative"><svg viewBox="0 0 128 128" style="height: 3rem;"><path d="M64.004 25.602c-17.067 0-27.73 8.53-32 25.597 6.398-8.531 13.867-11.73 22.398-9.597 4.871 1.214 8.352 4.746 12.207 8.66C72.883 56.629 80.145 64 96.004 64c17.066 0 27.73-8.531 32-25.602-6.399 8.536-13.867 11.735-22.399 9.602-4.87-1.215-8.347-4.746-12.207-8.66-6.27-6.367-13.53-13.738-29.394-13.738zM32.004 64c-17.066 0-27.73 8.531-32 25.602C6.402 81.066 13.87 77.867 22.402 80c4.871 1.215 8.352 4.746 12.207 8.66 6.274 6.367 13.536 13.738 29.395 13.738 17.066 0 27.73-8.53 32-25.597-6.399 8.531-13.867 11.73-22.399 9.597-4.87-1.214-8.347-4.746-12.207-8.66C55.128 71.371 47.868 64 32.004 64zm0 0" fill="#38b2ac"></path></svg><span class="tooltip">TailwindCSS</span></div>'

const socials_list = [Instagram_html, Linkedin_html, Telegram_html, Github_html];

const languages_html = [python_html, css_html, html_html, javascript_html];
const framework_html = [tailwindcss_html];
const others_html = [];

const internships_display = ["No one wants to hire Brendan...", "Will you hire Brendan?", "no?", "u suck"];
const education_display = ["VJC: 2019-2020", "NUS Computer Science: 2022-Present"];
const project_display = ["Work in Progress..."]

const intro_display = ["Hi! I am Brendan, a year 1 undergraduate studying Computer Science at National University of Singapore.", "Welcome to my interactive portfolio website that is inspired by Pokémon FireRed! You can do damage using About-Buttons. Once my health indicator turns red, Hire me!"]
const run1 = ["You couldn't get away!"]
const run2 = ["Stop trying."]
const run3 = ["..."]

const techtop_display = ["Languages", "Web Development Framework & Libraries", "Others"];

const techbottom_display = [languages_html, framework_html, others_html];

let display_status = false;
let display_sequence = [];
let display_num = 1;

function showIcons(id, icon_list){
	document.getElementById(id).innerHTML = "";
    var speed = 200;
    let i = 0;
    function show(){
        if (i < icon_list.length){
            document.getElementById(id).innerHTML += icon_list[i];
            i++;
            setTimeout(show, speed);
        }
        else{
        i = 0
        }
    }
    show()
}

let fast_forward = false;
function typeWriter(id, text){
	fast_forward = false;
	document.getElementById(id).innerHTML = "";
    var speed = 50;
    let letter_index = 0;
    function type(){
		if (letter_index<text.length && !fast_forward){
			display_status = true;
			document.getElementById(id).innerHTML += text.charAt(letter_index);
			letter_index++;
			setTimeout(type, speed);
		}
		else{
			letter_index = 0;
			display_status = false;
		}
	}
    type();
}

function hideElement(id){
    document.getElementById(id).style.display = 'none';
}

function showElement(id, display_type){
    document.getElementById(id).style.display = `${display_type}`;
}

function doDamage(id, damage){
	let i = 0;
	function damage_animation(){
		document.getElementById("enemy_img").classList.add("damaged");
	}
	setTimeout(damage_animation,2000)
	if (!hired){
		document.getElementById("paper-right").classList.add("paper-right");
		document.getElementById("paper-left").classList.add("paper-left");
	}
	function damageTick(){
		if(i < damage){
			let current_health_str = document.getElementById(id).style.width;
			let current_health_int = parseInt(current_health_str);
			current_health_int -= 1;
			document.getElementById(id).style.width = `${current_health_int}%`;
			setTimeout(damageTick, 100);
			i++;
			if (current_health_int <= 50 && current_health_int > 20){
				document.getElementById(id).classList.remove("bg-pklightgreen");
				document.getElementById(id).classList.add("bg-amber-500")
			}
			else if (current_health_int <= 20){
				document.getElementById(id).classList.remove("bg-pklightgreen");
				document.getElementById(id).classList.remove("bg-amber-500");
				document.getElementById(id).classList.add("bg-red-700");
			}
		}
		else{
			document.getElementById("enemy_img").classList.remove("damaged");
			document.getElementById("paper-right").classList.remove("paper-right");
			document.getElementById("paper-left").classList.remove("paper-left");
		}
	}
	setTimeout(damageTick,2500);
}

function blackScreen(){
	screen_top = document.getElementById("screen-top");
	screen_bottom = document.getElementById("screen-bottom");
	setTimeout(()=>{typeWriter("intro-text", "Welcome to Brendan's Portfolio Website")}, 2000);
	setTimeout(()=>{
		hideElement("textbox");
		showElement("whole_menu", "grid");
		screen_top.classList.remove("startup1");
		screen_bottom.classList.remove("startup1");
		screen_top.classList.add("startup2");
		screen_bottom.classList.add("startup2");
		screen_bottom.classList.add("border-t-4");
		screen_bottom.classList.add("sm:border-t-8");
		screen_bottom.classList.add("bottom_startup");
		document.getElementById("attack_menu").classList.add("bottom_startup");
		screen_top.classList.remove("bg-pkblack");
		screen_bottom.classList.remove("bg-pkblack");
		
	}, 5000)
	setTimeout(()=>{hideElement("intro-text");},6000)
	setTimeout(()=>{
		Introduction();
		screen_bottom.classList.remove("bottom_startup");
		document.getElementById("attack_menu").classList.remove("bottom_startup");
		screen_bottom.classList.remove("startup2")
		screen_top.classList.remove("startup2");
	}, 8000)
}

function Introduction(){
	if (!display_status){
		showElement("whole_menu");
		showElement("attack_menu", "block");
		display_sequence = intro_display;
		display_status = true;
		typeWriterPromise("attack_menu", display_sequence[0]);
		document.getElementById("attack_menu").onclick = nextIntro;
	}
}

function typeWriterPromise(id, text){
	return new Promise((resolve, reject) => {
		fast_forward = false;
		document.getElementById(id).innerHTML = "";
		var speed = 50;
		let letter_index = 0;
		display_status = true;
		function type(){
			if (letter_index<text.length && !fast_forward){
				display_status = true;
				document.getElementById(id).innerHTML += text.charAt(letter_index);
				letter_index++;
				setTimeout(type, speed);
			}
			else{
				letter_index = 0;
				resolve("finish");
			}
		}
		type();	
	})
}

function nextIntro(){
	display_status = true;
	let current_text = document.getElementById("attack_menu").innerHTML;
	if (current_text.length != display_sequence[display_num-1].length){
		fast_forward = true;
		display_status = true;
		document.getElementById("attack_menu").innerHTML = "";
		document.getElementById("attack_menu").innerHTML = display_sequence[display_num-1];
	}
	else if (display_num < display_sequence.length - 1){
		typeWriter("attack_menu", display_sequence[display_num]);
		display_num += 1;
		display_status = true;
		
	}
	else if (display_num + 1 == display_sequence.length){
		display_num++
		typeWriterPromise("attack_menu", display_sequence[display_num - 1]).then(() => {
		document.getElementById("attack_menu").onclick = "";
		display_num = 1;
		display_sequence = []; 
		fast_forward = false;
		display_status = false;
		})
	}
}

function ContactMe(){
	if (!display_status){
		hideElement("textbox");
		hideElement("attack_menu");
		showElement("social_menu", "block");
		typeWriter("social_top", "Here are my socials :D");
		showIcons("social_middle", socials_list);
		typeWriter("social_bottom", "Feel free to contact me!");
	}
}

function AboutMe(){
	if (!display_status){
		hideElement("social_menu");
		showElement("attack_menu", "grid");
		document.getElementById("attack_menu").classList.remove("px-1");
		document.getElementById("attack_menu").innerHTML = '<button class="attack_button" onclick="Internships()">INTERNSHIPS</button><button class="attack_button" onclick="Education()">EDUCATION</button><button class="attack_button" onclick="Projects()">PROJECTS</button><button class="attack_button" onclick="Technology()">TECHNOLOGY</button>';
	}
}

function Run1(){
	if (!display_status){
		generalDisplay(run1);
		document.getElementById("run_button").onclick = Run2;
	}
}

function Run2(){
	if (!display_status){
		generalDisplay(run2);
		document.getElementById("run_button").onclick = Run3;
	}
}

function Run3(){
	if (!display_status){
		generalDisplay(run3);
	}
}

function generalDisplay(textlist_chosen){
	display_sequence = textlist_chosen;
	hideElement("whole_menu");
	showElement("textbox", "block");
	typeWriter("textbox", display_sequence[0]);
	doDamage("enemy_health", 10);
}

function nextText(){
	let current_text = document.getElementById("textbox").innerHTML;
	if (current_text.length != display_sequence[display_num-1].length){
		fast_forward = true;
		document.getElementById("textbox").innerHTML = "";
		document.getElementById("textbox").innerHTML = display_sequence[display_num-1];
	}
	else if (display_num < display_sequence.length){
		typeWriter("textbox", display_sequence[display_num]);
		display_num += 1;
	}
	else{
		display_num = 1;
		display_sequence = [];
		hideElement("textbox");
		showElement("whole_menu", "grid");
	}

	
}

function Internships(){
	generalDisplay(internships_display);
}

function Education(){
	generalDisplay(education_display);
}

function Projects(){
	generalDisplay(project_display);
}

function Technology(){
	hideElement("whole_menu");
	showElement("textbox", "block");
	document.getElementById("textbox").innerHTML = "";
	document.getElementById("textbox").innerHTML += "<div span id='tech_top'></div><div class='flex justify-center' id='tech_bottom'></div><div class='text-amber-50'>This is just for the tooltip</div>";
	typeWriter("tech_top", techtop_display[0]);
	showIcons("tech_bottom", techbottom_display[0]);
	document.getElementById("textbox").onclick = nextSlide;
	doDamage("enemy_health", 25);
}

let slide_num = 1;
function nextSlide(){
	if (!display_status){
		if (slide_num < techbottom_display.length){
			display_status = true;
			typeWriter("tech_top", techtop_display[slide_num]);
			showIcons("tech_bottom", techbottom_display[slide_num]);
			slide_num++;
		}
		else{
			document.getElementById("textbox").innerHTML = "";
			hideElement("textbox");
			showElement("whole_menu", "grid");
			showElement("attack_menu", "grid");
			slide_num = 1;
			document.getElementById("textbox").onclick = nextText;
		}
	}
}
let hired = false
function Hire(){
	if (!display_status && !hired){
		hired = true
		showElement("pokeball", "flex")
		display_status = true;
		let pokeball = document.getElementById("pokeball");
		let nerd = document.getElementById("enemy_img");
		let x0 = pokeball.getBoundingClientRect().left + pokeball.offsetWidth/2;
		let y0 = pokeball.getBoundingClientRect().top + pokeball.offsetHeight/2;
		let xf = nerd.getBoundingClientRect().left + nerd.offsetWidth/2.3;
		let yf = nerd.getBoundingClientRect().top + nerd.offsetHeight/2.5;
		let xChange = Math.round(xf - x0);
		let yChange = Math.round(y0 - yf);
		let k = Math.round(yChange*1.3);
		let h = xChange/(1+Math.sqrt((yChange-k)/-k))
		let a = -k/h**2;
		let x = 0;
		let y;
		
		typeWriter("attack_menu", "J.P Morgan offered Brendan a contract!");
		
		let projectile_motion = new Promise((resolve, reject) => {
			function projectileMotion(){
				let speed = 10
				if (x < xChange){
					if (x/xChange > 0.7){
						x += 1
					}
					x += speed;
					y = a*((x-h)**2) + k;
					pokeball.style.transform = `translate(${x}px, ${-y}px) rotate(45deg)`;
					setTimeout(projectileMotion, 10)
				}
				else{
					pokeball.innerHTML = '<svg id="open_mail" class="absolute -rotate-45 text-pkblack" height="1.5rem" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><title>envelope-open</title><path d="M30.738 11.941c-0-0.030-0.002-0.059-0.006-0.088l0 0.004c-0.009-0.033-0.019-0.060-0.030-0.086l0.002 0.005c-0.014-0.044-0.029-0.082-0.047-0.119l0.002 0.004c-0.014-0.030-0.027-0.055-0.042-0.079l0.002 0.003-0.010-0.021c-0.011-0.016-0.029-0.024-0.041-0.039-0.028-0.034-0.058-0.064-0.090-0.091l-0.001-0.001c-0.016-0.013-0.024-0.032-0.041-0.044l-14.024-10.011c-0.041-0.025-0.089-0.047-0.14-0.064l-0.005-0.001c-0.078-0.041-0.17-0.064-0.267-0.064s-0.189 0.024-0.27 0.066l0.003-0.002c-0.055 0.018-0.103 0.040-0.148 0.067l0.003-0.002-0.024 0.011-14 10c-0.017 0.012-0.025 0.031-0.041 0.044-0.033 0.028-0.062 0.057-0.089 0.089l-0.001 0.001c-0.013 0.016-0.032 0.024-0.044 0.041l-0.010 0.023c-0.012 0.020-0.025 0.044-0.036 0.069l-0.002 0.004c-0.016 0.032-0.032 0.070-0.044 0.109l-0.001 0.005c-0.009 0.022-0.019 0.049-0.027 0.077l-0.001 0.005c-0.003 0.025-0.005 0.054-0.006 0.083v0c-0.002 0.021-0.012 0.038-0.012 0.059v16c0.002 1.518 1.232 2.748 2.75 2.75h24c1.518-0.002 2.748-1.232 2.75-2.75v-16c0-0.021-0.010-0.038-0.012-0.059zM16 21.079l-12.71-9.079 12.71-9.079 12.71 9.079zM28 29.25h-24c-0.69-0.001-1.249-0.56-1.25-1.25v-14.543l12.814 9.152c0.013 0.010 0.031 0.006 0.044 0.014 0.108 0.073 0.241 0.119 0.383 0.124l0.001 0 0.005 0.002h0.002l0.005-0.002c0.144-0.005 0.276-0.051 0.387-0.126l-0.003 0.002c0.014-0.009 0.031-0.005 0.044-0.014l12.814-9.152v14.543c-0.001 0.69-0.56 1.249-1.25 1.25h-0z"></path></svg>'
					resolve()
				}
			}
			projectileMotion();
		})

		function hideNerd(){
			console.log(x)
			console.log(y)
			hideElement("enemy_img");
			pokeball.innerHTML = '<svg id="close_mail" class="absolute -rotate-45 text-pkblack" height="1.5rem" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><title>envelope</title><path d="M28 4.25h-24c-1.518 0.002-2.748 1.232-2.75 2.75v18c0.002 1.518 1.232 2.748 2.75 2.75h24c1.518-0.002 2.748-1.232 2.75-2.75v-18c-0.002-1.518-1.232-2.748-2.75-2.75h-0zM4 5.75h24c0.563 0.005 1.036 0.386 1.18 0.904l0.002 0.009-13.182 9.416-13.182-9.416c0.146-0.527 0.619-0.908 1.181-0.913h0.001zM28 26.25h-24c-0.69-0.001-1.249-0.56-1.25-1.25v-16.543l12.814 9.153c0.014 0.010 0.032 0.006 0.046 0.015 0.108 0.073 0.24 0.118 0.382 0.123l0.001 0 0.005 0.002h0.002l0.005-0.002c0.143-0.005 0.275-0.051 0.386-0.125l-0.003 0.002c0.014-0.009 0.032-0.005 0.046-0.015l12.814-9.153v16.543c-0.001 0.69-0.56 1.249-1.25 1.25h-0z"></path></svg>';
		}

		let drop_height = 60;
		let current_height = 0
		let speed = 8;
		function ballFall(){
			if (current_height<drop_height){
				current_height += speed;
				y -= speed;
				pokeball.style.transform = `translate(${x}px, ${-y}px) rotate(45deg)`;
				setTimeout(ballFall, 10);
			}
			else{
				let delay = 300;
				let count = 2;
				for (let i=0; i<count; i++){
					setTimeout(()=>{pokeball.style.transform = `translate(${x}px, ${-y}px) rotate(67.5deg)`}, delay + delay*2*i)
					setTimeout(()=>{pokeball.style.transform = `translate(${x}px, ${-y}px) rotate(22.5deg)`}, 2*delay + delay*2*i)
				}
				setTimeout(()=>{pokeball.style.transform=`translate(${x}px, ${-y}px) rotate(45deg)`;typeWriter("attack_menu", "HAHAHAHA YOU KEEP DREAMING!")}, delay + delay*2*count)
			}
		}

		projectile_motion.then(() => {
			nerd.classList.add("shrink");
		})
		.then(() => setTimeout(hideNerd, 1000))
		.then(setTimeout(ballFall, 1500))
	}
}